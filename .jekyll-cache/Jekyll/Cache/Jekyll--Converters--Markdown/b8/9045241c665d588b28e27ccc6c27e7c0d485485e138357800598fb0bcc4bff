I"<ol>
  <li>Rails 删除小结</li>
</ol>

<p>delete_all 不会走 callback, 会直接生成一条 delete SQL 语句
Project.where(id: 1).delete_all</p>
<h1 id="delete-from-projects-where-projectsid--a1--id-1">DELETE FROM “PROJECTS” WHERE “PROJECTS”.”ID” = :a1  [[“id”, 1]]</h1>

<p>destroy_all 会走 callback（相关的数据也都删除）, 会生成多条 delete SQL 语句
Project.where(id: [1, 2]).delete_all</p>
<h1 id="delete-from-projects-where-projectsid--a1--id-1-1">DELETE FROM “PROJECTS” WHERE “PROJECTS”.”ID” = :a1  [[“id”, 1]]</h1>
<h1 id="delete-from-projects-where-projectsid--a1--id-2">DELETE FROM “PROJECTS” WHERE “PROJECTS”.”ID” = :a1  [[“id”, 2]]</h1>

<p>同时也会把模型中 has_many 配置了 dependent: :delete_all 或者 dependent: :destroy 的给删除掉</p>

<p>dependent: :delete_all, 会生成一条 delete SQL 语句, has_many 全部删除, 不会走 callback</p>
<h1 id="delete-from-projects_survey_seeds-where-projects_survey_seedsproject_id--a1--project_id-1">DELETE FROM “PROJECTS_SURVEY_SEEDS” WHERE “PROJECTS_SURVEY_SEEDS”.”PROJECT_ID” = :a1  [[“project_id”, 1]]</h1>

<p>dependent: :destroy 会生成多条 delete SQL 语句, has_many 全部删除, 会走 callback（相关的数据也都删除）</p>
<h1 id="delete-from-projects_survey_seeds-where-project_extra_propertiesid--a1--id-1804">DELETE FROM “PROJECTS_SURVEY_SEEDS” WHERE “PROJECT_EXTRA_PROPERTIES”.”ID” = :a1  [[“id”, 1804]]</h1>
<h1 id="delete-from-projects_survey_seeds-where-project_extra_propertiesid--a1--id-1803">DELETE FROM “PROJECTS_SURVEY_SEEDS” WHERE “PROJECT_EXTRA_PROPERTIES”.”ID” = :a1  [[“id”, 1803]]</h1>

<p>特别注意：
Project.find(1).projects_survey_seeds</p>

:ET